---
// src/pages/[lang]/index.astro
import Layout from '../../layouts/Layout.astro';
import { getPageInfo } from '../../lib/wp.js';
import LanguageSwitcher from '../../components/LanguageSwitcher.astro';

// Obtén el parámetro 'lang' de la URL
const { lang } = Astro.params;


// Mapeo de slugs a los idiomas disponibles
const slugMap = {
  es: 'home-es',
  ca: 'home-ca',
  en: 'home-en',
};

// Verifica si el idioma es válido
if (!slugMap[lang]) {
  throw new Error(`Idioma ${lang} no soportado`);
}

// Realiza la solicitud a la API de WordPress usando el slug correspondiente
const afc = await getPageInfo(slugMap[lang]);

export const prerender = false;
---

<Layout>
  <LanguageSwitcher currentLang={lang} />
  <div class="flex flex-col items-center justify-center bg-green-100 p-4">
    <h2 class="text-xl text-white border-white">{afc.difusion_descripcion}</h2>
    <p>{afc.difusion_link}</p>
  </div>
</Layout>
